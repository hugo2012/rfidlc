sap.ui.define(["sap/ui/base/Object","sap/m/MessageBox"],function(e,r){"use strict";return e.extend("com.bosch.rbf0.lo.rfidlc.controller.ErrorHandler",{constructor:function(e){this._oResourceBundle=e.getModel("i18n").getResourceBundle();this._oComponent=e;this._oModel=e.getModel();this._bMessageOpen=false;this._sErrorText=this._oResourceBundle.getText("errorText");this._oModel.attachMetadataFailed(function(e){var r=e.getParameters();this._showServiceError(r.response)},this);this._oModel.attachRequestFailed(function(e){var r=e.getParameters();if(r.response.statusCode!=="404"||r.response.statusCode===404&&r.response.responseText.indexOf("Cannot POST")===0){this._showServiceError(r.response)}},this)},_showServiceError:function(e){if(this._bMessageOpen){return}var s=this._getErrorText(e),t=this._sErrorText+"\n\n"+s+"\n\n";this._bMessageOpen=true;r.error(t,{id:"serviceErrorMessageBox",details:e,styleClass:this._oComponent.getContentDensityClass(),actions:[r.Action.CLOSE],onClose:function(){this._bMessageOpen=false}.bind(this)})},_getErrorText:function(e){var r="",s="",t=true;if(e.responseText){try{for(var o=0;o<JSON.parse(e.responseText).error.innererror.errordetails.length;o++){if(JSON.parse(e.responseText).error.innererror.errordetails[o].code==="/IWBEP/CX_MGW_BUSI_EXCEPTION"){t=false}}if(t){r=JSON.parse(e.responseText).error.message.value}if(JSON.parse(e.responseText).error.innererror.errordetails.length>0){s=JSON.parse(e.responseText).error.innererror.errordetails[0].message;while(s.indexOf("&")!==-1){s=s.replace("&","")}}}catch(s){var n=jQuery.parseXML(e.responseText);var a=jQuery(n);r=a.find("message").text()}return r+" "+s}return r},_parseXML:function(e){try{var r=$.parseXML(e),s=$(r),t=s.find("message");return t.text()}catch(e){return null}},_parseJson:function(e){var r=JSON.parse(e);if(r){return r.error.message.value}return null}})});
//# sourceMappingURL=ErrorHandler.js.map